---
title: 追加機能実装計画書（テンプレート）
project: "<プロジェクト名>"
version: "v0.1"
owner: "<作成者>"
last_updated: "YYYY-MM-DD"
---

# 1. 概要

## 1.1 目的

* 既存システムに **追加機能** を安全かつ効率的に実装する
* 既存機能への **影響範囲（リグレッション）** を特定し、破壊的変更を防ぐ
* この計画書をもとに、既存のアーキテクチャ・運用ルールに沿ってタスクを洗い出す

## 1.2 成果物（ゴール）

* リリース対象: <対象のWebアプリケーション>, <APIサーバー>
* リリース形態: 機能追加リリース（vX.X.X）
* リリース日（目標）: YYYY-MM-DD

## 1.3 スコープ

### In Scope（今回作るもの）

* <追加機能を列挙>
  * 例: **新機能**: クーポン機能(F-EXT-01)、クーポン管理画面(F-EXT-02)
  * 例: **既存改修**: 注文画面でのクーポン適用(F-05改修)

### Impact Scope（影響を受ける既存機能）

> **重要**: ここで挙げた機能はリグレッションテストの対象となる

* 例: 注文作成フロー（クーポン適用による金額計算ロジック変更）
* 例: マイページ（クーポン表示エリアの追加）

### Out of Scope（今回やらない）

* 例: クーポンの自動発行Bat
* 例: 既存のポイント機能との併用

## 1.4 前提・制約

* 既存の技術スタック・アーキテクチャに準拠する
* データベースの破壊的変更（既存データの削除・不整合）は禁止
* 既存の認証基盤・デザインシステムを利用する

## 1.5 参照ドキュメント

* **必須**: `templates/design/extensions/feature_extension_template.md`（機能拡張詳細設計）
* 例: `templates/design/01_basic_design.md`（既存の基本設計）
* 例: `templates/design/db/03_db_design.md`（既存のDB設計）

---

# 2. 開発の進め方（チーム戦略）

## 2.1 体制

* **Feature Owner**: <氏名>（この機能追加の責任者）
* **Developer**: <氏名>
* **Reviewer**: <氏名>（既存システムに詳しい人が望ましい）

## 2.2 ブランチ/タスク運用

* ベースブランチ: `main` or `develop`（プロジェクトの運用に従う）
* 作業ブランチ: `feature/add-coupon-function` 等
* 既存コードへの変更:
  * 既存ロジックを修正する場合は、必ず **単体テスト** を修正・追加し、既存の挙動が壊れていないことを保証する。

---

# 3. 影響範囲と依存関係

## 3.1 機能・画面一覧

### 新規・変更カタログ

| ID | 種別 | 名称 | 区分 | 備考 |
| -- | -- | -- | -- | -- |
| F-EXT-01 | 機能 | クーポン管理 | 新規 | 管理画面 |
| S-EXT-01 | 画面 | クーポン一覧 | 新規 | 管理画面 |
| F-05 | 機能 | 注文作成 | **改修** | 金額計算ロジック変更 |
| S-06 | 画面 | 注文確認 | **改修** | クーポン選択UI追加 |

## 3.2 依存関係

* 前提: 既存の「商品DB」「ユーザーDB」
* 依存: 「注文機能」の実装完了（もし並行開発なら調整が必要）

---

# 4. モック方針

* 既存APIが利用可能な場合は、モック不要で接続する
* 新規APIの開発が遅れる場合は、MSW等でモックを作成し、FEの実装を止めない

---

# 5. フェーズ別 実装計画

## Phase 0: 影響調査 & 設計（最重要）

**ここで「既存システムを壊さないこと」を確認する**

| 優先 | タスクID | 内容 | 担当 | 完了条件 |
| :--- | :--- | :--- | :--- | :--- |
| P0 | T-001 | 影響範囲調査（コードリーディング） | | 修正が必要な既存ファイル・テーブルの特定 |
| P0 | T-002 | 機能拡張設計書の作成 | | `templates/design/extensions/feature_extension_template.md` の作成 |
| P0 | T-003 | DBスキーマ変更計画 | | マイグレーション設計（既存データ移行含む） |
| P0 | T-004 | API I/F設計（新規・変更） | | OpenAPI更新・互換性確認 |

## Phase 1: 環境準備 & 基盤修正

| 優先 | タスクID | 内容 | 担当 | 備考 |
| :--- | :--- | :--- | :--- | :--- |
| P1 | T-005 | ライブラリ追加/更新（必要な場合） | | バージョン競合に注意 |
| P0 | T-006 | DBマイグレーション作成 | | ローカル環境で適用確認 |
| P1 | T-007 | 共通型定義/定数の追加 | | Enum, DTO等 |

## Phase 2: バックエンド実装

| 優先 | タスクID | 内容 | 担当 | 備考 |
| :--- | :--- | :--- | :--- | :--- |
| P0 | T-008 | 新規API実装 | | |
| P0 | T-009 | **既存APIロジック改修** | | **テスト追加必須** |
| P1 | T-010 | バッチ処理実装（あれば） | | |

## Phase 3: フロントエンド実装

| 優先 | タスクID | 内容 | 担当 | 備考 |
| :--- | :--- | :--- | :--- | :--- |
| P0 | T-011 | 新規画面作成 | | |
| P0 | T-012 | **既存画面UI改修** | | 既存コンポーネントへの影響確認 |
| P1 | T-013 | 状態管理 (Store) 修正 | | |

## Phase 4: 結合 & リグレッションテスト

| 優先 | タスクID | 内容 | 担当 | 備考 |
| :--- | :--- | :--- | :--- | :--- |
| P0 | T-014 | 新機能のE2Eテスト | | |
| P0 | T-015 | **影響範囲のリグレッションテスト** | | 手動 or 自動テスト実行 |
| P1 | T-016 | 既存データの整合性チェック | | データ移行が正しく行われたか |

## Phase 5: リリース

| 優先 | タスクID | 内容 | 担当 | 備考 |
| :--- | :--- | :--- | :--- | :--- |
| P0 | T-017 | リリース手順書作成 | | DBマイグレーション手順含む |
| P0 | T-018 | 本番リリース | | |
| P0 | T-019 | 動作確認 | | |

---

# 6. リスクと対策

| リスク | 影響 | 対策 |
| -- | -- | -- |
| リグレッション | 既存機能（注文等）が停止 | 影響範囲の特定と重点テスト（T-001, T-015） |
| データ不整合 | 過去データの計算が狂う | マイグレーション時のデータ補正・検証 |
| パフォーマンス低下 | 追加ロジックによる遅延 | スロークエリ確認、N+1確認 |

---

# 7. 変更履歴

| 日付 | 変更者 | 変更内容 |
| -- | -- | -- |
| YYYY-MM-DD | | 初版 |
